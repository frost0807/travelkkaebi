<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="src.main.resources.mapper.ReviewMapper">

    <resultMap id="ReviewResult" type="ReviewDTO">
        <result column="review_id" property="reviewId"/>
        <result column="category_id" property="categoryId"/>
        <result column="writer_id" property="writerId"/>
        <result column="title" property="title"/>
        <result column="content" property="content"/>
        <result column="region" property="region"/>
        <result column="like_count" property="likeCount"/>
        <result column="dislike_count" property="dislikeCount"/>
        <result column="view" property="view"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>

    </resultMap>

    <!-- 게시판 최신순으로 출력 -->
    <select id="selectAll" resultType="ReviewDTO" parameterType="hashmap">
        SELECT * FROM board_review LIMIT #{startNum}, #{PAGE_SIZE} ORDER BY review_id desc;
    </select>

    <!-- 후기 상세보기-->
    <select id="selectAllByReviewId" resultType="ReviewDTO" parameterType="int">
        SELECT * FROM board_review WHERE review_id = #{reviewId}
    </select>

    <!-- 후기 게시판 등록 -->
    <insert id="insert"  useGeneratedKeys="true" keyProperty="reviewId" parameterType="reviewDTO">
        INSERT INTO board_review (category_id, writer_id, title, content, region)
        VALUES (#{categoryId}, #{writerId}, #{title}, #{content}, #{region})
    </insert>

    <insert id="insert2">
        INSERT INTO test (testcol) VALUES ("aaa")
    </insert>

    <update id="update" useGeneratedKeys="true" keyProperty="reviewId" parameterType="reviewDTO">
        UPDATE board_review SET title = #{title}, content = #{content}, region = #{region},
                                update_time = NOW() WHERE review_id = #{reviewId}
    </update>

    <delete id="delete" parameterType="int">
        DELETE FROM board_review WHERE review_id = #{reviewId}
    </delete>

    <update id="viewPlus" useGeneratedKeys="true" keyProperty="view" parameterType="reviewDTO">
        UPDATE board_review SET view = #{view} + 1 WHERE review_id = #{reviewId}
    </update>


</mapper>